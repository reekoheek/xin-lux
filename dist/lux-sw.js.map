{"version":3,"sources":["webpack:///./lux-sw.js","webpack:///./sw/service-worker.js","webpack:///./~/sw-toolbox/sw-toolbox.js","webpack:///./~/sw-toolbox/sw-toolbox.js.map"],"names":["isServiceWorkerSupported","navigator","LuxSw","console","error","params","version","skipWaiting","clientsClaim","debug","defaultCacheStrategy","Promise","all","map","call","children","el","_getParameters","childParams","forEach","Object","keys","param","key","concat","url","href","_serializeUrlParams","serviceWorker","register","registration","window","sw","info","scope","name","message","warn","sort","encodeURIComponent","join","mix","type","String","value","Boolean","Component","define"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AAEA;;AACA;;AACA;;;;;;;;;;;;AAEA,UAASA,wBAAT,GAAqC;AACnC,UAAO,mBAAmBC,SAA1B;AACD;;KAEKC,K;;;;;;;;;;;;;;;;;;;AA+BF;;qBAEKF,0B;;;;;AACHG,yBAAQC,KAAR,CAAc,kCAAd;;;;;;;;;;;AAKIC,iC,GAAS;AACXC,sCAAS,KADE;AAEXC,0CAAa,OAAKA,WAFP;AAGXC,2CAAc,OAAKA,YAHR;AAIXC,oCAAO,OAAKA,KAJD;AAKXC,mDAAsB,OAAKA;AALhB,4B;;kCAQWC,QAAQC,GAAR,CAAY,GAAGC,GAAH,CAAOC,IAAP,CAAY,OAAKC,QAAjB,EAA2B;AAAA,oCAAMC,GAAGC,cAAH,EAAN;AAAA,4BAA3B,CAAZ,C;;;AAApBC,sC;;;AAEJA,uCAAYC,OAAZ,CAAoB,iBAAS;AAC3BC,oCAAOC,IAAP,CAAYC,KAAZ,EAAmBH,OAAnB,CAA2B,eAAO;AAChCd,sCAAOkB,GAAP,IAAc,CAAClB,OAAOkB,GAAP,KAAe,EAAhB,EAAoBC,MAApB,CAA2BF,MAAMC,GAAN,CAA3B,CAAd;AACD,8BAFD;AAGD,4BAJD;;AAMIE,8B,GAAS,OAAKC,I,SAAQ,OAAKC,mBAAL,CAAyBtB,MAAzB,C;;kCACWJ,UAAU2B,aAAV,CAAwBC,QAAxB,CAAiCJ,GAAjC,C;;;AAAjCK,uC,GAAeC,OAAOC,E;;;AAE1B7B,mCAAQ8B,IAAR,yDAAmEH,aAAaI,KAAhF;;;;;;;;;;;;;;;;;;AAEA/B,yBAAQC,KAAR,CAAiB,aAAI+B,IAArB,UAA8B,aAAIC,OAAlC;AACAjC,yBAAQkC,IAAR,wDAC4C,KAAKX,IADjD,4BAEa,KAAKA,IAFlB;;;;;;;;;;;;;;;;;;yCAYiBrB,M,EAAQ;AAC3B,cAAOe,OAAOC,IAAP,CAAYhB,MAAZ,EAAoBiC,IAApB,GAA2BzB,GAA3B,CAA+B;AAAA,gBAAU0B,mBAAmBhB,GAAnB,CAAV,SAAqCgB,mBAAmBlC,OAAOkB,GAAP,CAAnB,CAArC;AAAA,QAA/B,EAAuGiB,IAAvG,CAA4G,GAA5G,CAAP;AACD;;;yBA1EY;AACX,cAAO,cAAIC,GAAJ,2FAAqB;AAC1Bf,eAAM;AACJgB,iBAAMC,MADF;AAEJC,kBAAO;AAFH,UADoB;;AAM1BrC,sBAAa;AACXmC,iBAAMG,OADK;AAEXD,kBAAO;AAFI,UANa;;AAW1BpC,uBAAc;AACZkC,iBAAMG,OADM;AAEZD,kBAAO;AAFK,UAXY;;AAgB1BnC,gBAAO;AACLiC,iBAAMG,OADD;AAELD,kBAAO;AAFF,UAhBmB;;AAqB1BlC,+BAAsB;AACpBgC,iBAAMC,MADc;AAEpBC,kBAAO;AAFa;AArBI,QAArB,CAAP;AA0BD;;;;GA5BiB,cAAIE,S;;AA8ExB,eAAIC,MAAJ,CAAW,QAAX,EAAqB7C,KAArB;;mBAEeA,K;;;;;;;;;AC1Ff,mE;;;;;;ACAA,0E;;;;;;ACAA,8E","file":"lux-sw.js","sourcesContent":["import xin from 'xin';\n\nimport 'file?name=./sw/[name].[ext]!./sw/service-worker.js';\nimport 'file?name=./sw/sw-toolbox/[name].[ext]!./node_modules/sw-toolbox/sw-toolbox.js';\nimport 'file?name=./sw/sw-toolbox/[name].[ext]!./node_modules/sw-toolbox/sw-toolbox.js.map';\n\nfunction isServiceWorkerSupported () {\n  return 'serviceWorker' in navigator;\n}\n\nclass LuxSw extends xin.Component {\n  get props () {\n    return xin.mix(super.props, {\n      href: {\n        type: String,\n        value: 'sw-import.js',\n      },\n\n      skipWaiting: {\n        type: Boolean,\n        value: false,\n      },\n\n      clientsClaim: {\n        type: Boolean,\n        value: false,\n      },\n\n      debug: {\n        type: Boolean,\n        value: false,\n      },\n\n      defaultCacheStrategy: {\n        type: String,\n        value: 'networkFirst',\n      },\n    });\n  }\n\n  async attached () {\n    super.attached();\n\n    if (!isServiceWorkerSupported()) {\n      console.error('Service worker is not supported!');\n      return;\n    }\n\n    try {\n      let params = {\n        version: '1.0',\n        skipWaiting: this.skipWaiting,\n        clientsClaim: this.clientsClaim,\n        debug: this.debug,\n        defaultCacheStrategy: this.defaultCacheStrategy,\n      };\n\n      let childParams = await Promise.all([].map.call(this.children, el => el._getParameters()));\n\n      childParams.forEach(param => {\n        Object.keys(param).forEach(key => {\n          params[key] = (params[key] || []).concat(param[key]);\n        });\n      });\n\n      let url = `${this.href}?${this._serializeUrlParams(params)}`;\n      let registration = window.sw = await navigator.serviceWorker.register(url);\n\n      console.info(`Service worker registration successful with scope: ${registration.scope}`);\n    } catch (err) {\n      console.error(`${err.name}: ${err.message}`);\n      console.warn(`\nMaybe, a valid service worker script not found \"${this.href}\"\nCreate new file \"${this.href}\" and copy paste lines below,\n\n\\`\\`\\`javascript\n\nimportScripts('/sw/service-worker.js');\n\n\\`\\`\\``);\n    }\n  }\n\n  _serializeUrlParams (params) {\n    return Object.keys(params).sort().map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`).join('&');\n  }\n}\n\nxin.define('lux-sw', LuxSw);\n\nexport default LuxSw;\n\n\n\n// WEBPACK FOOTER //\n// ./lux-sw.js","module.exports = __webpack_public_path__ + \"./sw/service-worker.js\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/[name].[ext]!./sw/service-worker.js\n// module id = 4\n// module chunks = 2","module.exports = __webpack_public_path__ + \"./sw/sw-toolbox/sw-toolbox.js\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/sw-toolbox/[name].[ext]!./~/sw-toolbox/sw-toolbox.js\n// module id = 5\n// module chunks = 2","module.exports = __webpack_public_path__ + \"./sw/sw-toolbox/sw-toolbox.js.map\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/sw-toolbox/[name].[ext]!./~/sw-toolbox/sw-toolbox.js.map\n// module id = 6\n// module chunks = 2"],"sourceRoot":""}
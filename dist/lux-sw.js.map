{"version":3,"sources":["webpack:///./sw/service-worker.js","webpack:///./~/sw-toolbox/sw-toolbox.js","webpack:///./~/sw-toolbox/sw-toolbox.js.map","webpack:///./lux-sw.js"],"names":["isServiceWorkerSupported","navigator","LuxSw","console","error","params","version","skipWaiting","clientsClaim","debug","defaultCacheStrategy","baseUrl","window","URL","href","location","Promise","all","map","call","children","el","_getParameters","childParams","forEach","Object","keys","param","key","concat","url","_serializeUrlParams","serviceWorker","register","registration","sw","info","scope","name","message","warn","sort","encodeURIComponent","join","assign","type","String","value","Boolean","Component","define"],"mappings":";;;;;AAAA,kE;;;;;;;ACAA,yE;;;;;;;ACAA,6E;;;;;;;;;;;;;;;;;;ACAA;;;;AAEA;;AACA;;AACA;;;;;;;;;;;;AAEA,SAASA,wBAAT,GAAqC;AACnC,SAAO,mBAAmBC,SAA1B;AACD;;IAEKC,K;;;;;;;;;;;;;;;;;;;AA+BF;;oBAEKF,0B;;;;;AACHG,wBAAQC,KAAR,CAAc,kCAAd;;;;;;;;;;;AAKIC,gC,GAAS;AACXC,qCAAS,KADE;AAEXC,yCAAa,OAAKA,WAFP;AAGXC,0CAAc,OAAKA,YAHR;AAIXC,mCAAO,OAAKA,KAJD;AAKXC,kDAAsB,OAAKA;AALhB,2B;AAQTC,iC,GAAU,IAAIC,OAAOC,GAAX,CAAe,OAAKC,IAApB,EAA0BF,OAAOG,QAAP,CAAgBD,IAA1C,C;;iCAEUE,QAAQC,GAAR,CAAY,GAAGC,GAAH,CAAOC,IAAP,CAAY,OAAKC,QAAjB,EAA2B;AAAA,mCAAMC,GAAGC,cAAH,CAAkBX,OAAlB,CAAN;AAAA,2BAA3B,CAAZ,C;;;AAApBY,qC;;;AAEJA,sCAAYC,OAAZ,CAAoB,iBAAS;AAC3BC,mCAAOC,IAAP,CAAYC,KAAZ,EAAmBH,OAAnB,CAA2B,eAAO;AAChCnB,qCAAOuB,GAAP,IAAc,CAACvB,OAAOuB,GAAP,KAAe,EAAhB,EAAoBC,MAApB,CAA2BF,MAAMC,GAAN,CAA3B,CAAd;AACD,6BAFD;AAGD,2BAJD;;AAMIE,6B,GAAS,OAAKhB,I,SAAQ,OAAKiB,mBAAL,CAAyB1B,MAAzB,C;;iCACWJ,UAAU+B,aAAV,CAAwBC,QAAxB,CAAiCH,GAAjC,C;;;AAAjCI,sC,GAAetB,OAAOuB,E;;;AAE1BhC,kCAAQiC,IAAR,yDAAmEF,aAAaG,KAAhF;;;;;;;;;;;;;;;;;;AAEAlC,wBAAQC,KAAR,CAAiB,aAAIkC,IAArB,UAA8B,aAAIC,OAAlC;AACApC,wBAAQqC,IAAR,wDAC4C,KAAK1B,IADjD,4BAEa,KAAKA,IAFlB;;;;;;;;;;;;;;;;;;wCAYiBT,M,EAAQ;AAC3B,aAAOoB,OAAOC,IAAP,CAAYrB,MAAZ,EAAoBoC,IAApB,GAA2BvB,GAA3B,CAA+B;AAAA,eAAUwB,mBAAmBd,GAAnB,CAAV,SAAqCc,mBAAmBrC,OAAOuB,GAAP,CAAnB,CAArC;AAAA,OAA/B,EAAuGe,IAAvG,CAA4G,GAA5G,CAAP;AACD;;;wBA5EY;AACX,aAAOlB,OAAOmB,MAAP,CAAc,EAAd,4FAA+B;AACpC9B,cAAM;AACJ+B,gBAAMC,MADF;AAEJC,iBAAO;AAFH,SAD8B;;AAMpCxC,qBAAa;AACXsC,gBAAMG,OADK;AAEXD,iBAAO;AAFI,SANuB;;AAWpCvC,sBAAc;AACZqC,gBAAMG,OADM;AAEZD,iBAAO;AAFK,SAXsB;;AAgBpCtC,eAAO;AACLoC,gBAAMG,OADD;AAELD,iBAAO;AAFF,SAhB6B;;AAqBpCrC,8BAAsB;AACpBmC,gBAAMC,MADc;AAEpBC,iBAAO;AAFa;AArBc,OAA/B,CAAP;AA0BD;;;;EA5BiB,cAAIE,S;;AAgFxB,cAAIC,MAAJ,CAAW,QAAX,EAAqBhD,KAArB;;kBAEeA,K","file":"lux-sw.js","sourcesContent":["module.exports = __webpack_public_path__ + \"./sw/service-worker.js\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/[name].[ext]!./sw/service-worker.js\n// module id = 10\n// module chunks = 0","module.exports = __webpack_public_path__ + \"./sw/sw-toolbox/sw-toolbox.js\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/sw-toolbox/[name].[ext]!./~/sw-toolbox/sw-toolbox.js\n// module id = 12\n// module chunks = 0","module.exports = __webpack_public_path__ + \"./sw/sw-toolbox/sw-toolbox.js.map\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/sw-toolbox/[name].[ext]!./~/sw-toolbox/sw-toolbox.js.map\n// module id = 13\n// module chunks = 0","import xin from 'xin';\n\nimport 'file-loader?name=./sw/[name].[ext]!./sw/service-worker.js';\nimport 'file-loader?name=./sw/sw-toolbox/[name].[ext]!sw-toolbox/sw-toolbox.js';\nimport 'file-loader?name=./sw/sw-toolbox/[name].[ext]!sw-toolbox/sw-toolbox.js.map';\n\nfunction isServiceWorkerSupported () {\n  return 'serviceWorker' in navigator;\n}\n\nclass LuxSw extends xin.Component {\n  get props () {\n    return Object.assign({}, super.props, {\n      href: {\n        type: String,\n        value: 'sw-import.js',\n      },\n\n      skipWaiting: {\n        type: Boolean,\n        value: false,\n      },\n\n      clientsClaim: {\n        type: Boolean,\n        value: false,\n      },\n\n      debug: {\n        type: Boolean,\n        value: false,\n      },\n\n      defaultCacheStrategy: {\n        type: String,\n        value: 'networkFirst',\n      },\n    });\n  }\n\n  async attached () {\n    super.attached();\n\n    if (!isServiceWorkerSupported()) {\n      console.error('Service worker is not supported!');\n      return;\n    }\n\n    try {\n      let params = {\n        version: '1.0',\n        skipWaiting: this.skipWaiting,\n        clientsClaim: this.clientsClaim,\n        debug: this.debug,\n        defaultCacheStrategy: this.defaultCacheStrategy,\n      };\n\n      let baseUrl = new window.URL(this.href, window.location.href);\n\n      let childParams = await Promise.all([].map.call(this.children, el => el._getParameters(baseUrl)));\n\n      childParams.forEach(param => {\n        Object.keys(param).forEach(key => {\n          params[key] = (params[key] || []).concat(param[key]);\n        });\n      });\n\n      let url = `${this.href}?${this._serializeUrlParams(params)}`;\n      let registration = window.sw = await navigator.serviceWorker.register(url);\n\n      console.info(`Service worker registration successful with scope: ${registration.scope}`);\n    } catch (err) {\n      console.error(`${err.name}: ${err.message}`);\n      console.warn(`\nMaybe, a valid service worker script not found \"${this.href}\"\nCreate new file \"${this.href}\" and copy paste lines below,\n\n\\`\\`\\`javascript\n\nimportScripts('/sw/service-worker.js');\n\n\\`\\`\\``);\n    }\n  }\n\n  _serializeUrlParams (params) {\n    return Object.keys(params).sort().map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`).join('&');\n  }\n}\n\nxin.define('lux-sw', LuxSw);\n\nexport default LuxSw;\n\n\n\n// WEBPACK FOOTER //\n// ./lux-sw.js"],"sourceRoot":""}
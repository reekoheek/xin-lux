{"version":3,"sources":["webpack:///./lux-sw.js","webpack:///./sw/service-worker.js","webpack:///./~/sw-toolbox/sw-toolbox.js","webpack:///./~/sw-toolbox/sw-toolbox.js.map"],"names":["isServiceWorkerSupported","navigator","LuxSw","console","error","params","version","skipWaiting","clientsClaim","debug","defaultCacheStrategy","baseUrl","URL","href","location","Promise","all","map","call","children","el","_getParameters","childParams","forEach","Object","keys","param","key","concat","url","_serializeUrlParams","serviceWorker","register","registration","window","sw","info","scope","name","message","warn","sort","encodeURIComponent","join","assign","type","String","value","Boolean","Component","define"],"mappings":";;;;;;;;;;;;;;;AAAA;;;;AAEA;;AACA;;AACA;;;;;;;;;;;;AAEA,UAASA,wBAAT,GAAqC;AACnC,UAAO,mBAAmBC,SAA1B;AACD;;KAEKC,K;;;;;;;;;;;;;;;;;;;AA+BF;;qBAEKF,0B;;;;;AACHG,yBAAQC,KAAR,CAAc,kCAAd;;;;;;;;;;;AAKIC,iC,GAAS;AACXC,sCAAS,KADE;AAEXC,0CAAa,OAAKA,WAFP;AAGXC,2CAAc,OAAKA,YAHR;AAIXC,oCAAO,OAAKA,KAJD;AAKXC,mDAAsB,OAAKA;AALhB,4B;AAQTC,kC,GAAU,IAAIC,GAAJ,CAAQ,OAAKC,IAAb,EAAmBC,SAASD,IAA5B,C;;kCAEUE,QAAQC,GAAR,CAAY,GAAGC,GAAH,CAAOC,IAAP,CAAY,OAAKC,QAAjB,EAA2B;AAAA,oCAAMC,GAAGC,cAAH,CAAkBV,OAAlB,CAAN;AAAA,4BAA3B,CAAZ,C;;;AAApBW,sC;;;AAEJA,uCAAYC,OAAZ,CAAoB,iBAAS;AAC3BC,oCAAOC,IAAP,CAAYC,KAAZ,EAAmBH,OAAnB,CAA2B,eAAO;AAChClB,sCAAOsB,GAAP,IAAc,CAACtB,OAAOsB,GAAP,KAAe,EAAhB,EAAoBC,MAApB,CAA2BF,MAAMC,GAAN,CAA3B,CAAd;AACD,8BAFD;AAGD,4BAJD;;AAMIE,8B,GAAS,OAAKhB,I,SAAQ,OAAKiB,mBAAL,CAAyBzB,MAAzB,C;;kCACWJ,UAAU8B,aAAV,CAAwBC,QAAxB,CAAiCH,GAAjC,C;;;AAAjCI,uC,GAAeC,OAAOC,E;;;AAE1BhC,mCAAQiC,IAAR,yDAAmEH,aAAaI,KAAhF;;;;;;;;;;;;;;;;;;AAEAlC,yBAAQC,KAAR,CAAiB,aAAIkC,IAArB,UAA8B,aAAIC,OAAlC;AACApC,yBAAQqC,IAAR,wDAC4C,KAAK3B,IADjD,4BAEa,KAAKA,IAFlB;;;;;;;;;;;;;;;;;;yCAYiBR,M,EAAQ;AAC3B,cAAOmB,OAAOC,IAAP,CAAYpB,MAAZ,EAAoBoC,IAApB,GAA2BxB,GAA3B,CAA+B;AAAA,gBAAUyB,mBAAmBf,GAAnB,CAAV,SAAqCe,mBAAmBrC,OAAOsB,GAAP,CAAnB,CAArC;AAAA,QAA/B,EAAuGgB,IAAvG,CAA4G,GAA5G,CAAP;AACD;;;yBA5EY;AACX,cAAOnB,OAAOoB,MAAP,CAAc,EAAd,4FAA+B;AACpC/B,eAAM;AACJgC,iBAAMC,MADF;AAEJC,kBAAO;AAFH,UAD8B;;AAMpCxC,sBAAa;AACXsC,iBAAMG,OADK;AAEXD,kBAAO;AAFI,UANuB;;AAWpCvC,uBAAc;AACZqC,iBAAMG,OADM;AAEZD,kBAAO;AAFK,UAXsB;;AAgBpCtC,gBAAO;AACLoC,iBAAMG,OADD;AAELD,kBAAO;AAFF,UAhB6B;;AAqBpCrC,+BAAsB;AACpBmC,iBAAMC,MADc;AAEpBC,kBAAO;AAFa;AArBc,QAA/B,CAAP;AA0BD;;;;GA5BiB,cAAIE,S;;AAgFxB,eAAIC,MAAJ,CAAW,QAAX,EAAqBhD,KAArB;;mBAEeA,K;;;;;;;AC5Ff,mE;;;;;;;ACAA,0E;;;;;;;ACAA,8E","file":"lux-sw.js","sourcesContent":["import xin from 'xin';\n\nimport 'file?name=./sw/[name].[ext]!./sw/service-worker.js';\nimport 'file?name=./sw/sw-toolbox/[name].[ext]!sw-toolbox/sw-toolbox.js';\nimport 'file?name=./sw/sw-toolbox/[name].[ext]!sw-toolbox/sw-toolbox.js.map';\n\nfunction isServiceWorkerSupported () {\n  return 'serviceWorker' in navigator;\n}\n\nclass LuxSw extends xin.Component {\n  get props () {\n    return Object.assign({}, super.props, {\n      href: {\n        type: String,\n        value: 'sw-import.js',\n      },\n\n      skipWaiting: {\n        type: Boolean,\n        value: false,\n      },\n\n      clientsClaim: {\n        type: Boolean,\n        value: false,\n      },\n\n      debug: {\n        type: Boolean,\n        value: false,\n      },\n\n      defaultCacheStrategy: {\n        type: String,\n        value: 'networkFirst',\n      },\n    });\n  }\n\n  async attached () {\n    super.attached();\n\n    if (!isServiceWorkerSupported()) {\n      console.error('Service worker is not supported!');\n      return;\n    }\n\n    try {\n      let params = {\n        version: '1.0',\n        skipWaiting: this.skipWaiting,\n        clientsClaim: this.clientsClaim,\n        debug: this.debug,\n        defaultCacheStrategy: this.defaultCacheStrategy,\n      };\n\n      let baseUrl = new URL(this.href, location.href);\n\n      let childParams = await Promise.all([].map.call(this.children, el => el._getParameters(baseUrl)));\n\n      childParams.forEach(param => {\n        Object.keys(param).forEach(key => {\n          params[key] = (params[key] || []).concat(param[key]);\n        });\n      });\n\n      let url = `${this.href}?${this._serializeUrlParams(params)}`;\n      let registration = window.sw = await navigator.serviceWorker.register(url);\n\n      console.info(`Service worker registration successful with scope: ${registration.scope}`);\n    } catch (err) {\n      console.error(`${err.name}: ${err.message}`);\n      console.warn(`\nMaybe, a valid service worker script not found \"${this.href}\"\nCreate new file \"${this.href}\" and copy paste lines below,\n\n\\`\\`\\`javascript\n\nimportScripts('/sw/service-worker.js');\n\n\\`\\`\\``);\n    }\n  }\n\n  _serializeUrlParams (params) {\n    return Object.keys(params).sort().map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`).join('&');\n  }\n}\n\nxin.define('lux-sw', LuxSw);\n\nexport default LuxSw;\n\n\n\n// WEBPACK FOOTER //\n// ./lux-sw.js","module.exports = __webpack_public_path__ + \"./sw/service-worker.js\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/[name].[ext]!./sw/service-worker.js\n// module id = 24\n// module chunks = 2","module.exports = __webpack_public_path__ + \"./sw/sw-toolbox/sw-toolbox.js\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/sw-toolbox/[name].[ext]!./~/sw-toolbox/sw-toolbox.js\n// module id = 25\n// module chunks = 2","module.exports = __webpack_public_path__ + \"./sw/sw-toolbox/sw-toolbox.js.map\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./sw/sw-toolbox/[name].[ext]!./~/sw-toolbox/sw-toolbox.js.map\n// module id = 26\n// module chunks = 2"],"sourceRoot":""}